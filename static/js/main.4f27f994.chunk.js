(this["webpackJsonpdungeon-cards"]=this["webpackJsonpdungeon-cards"]||[]).push([[0],{16:function(e,t,n){},17:function(e,t,n){},24:function(e,t,n){},27:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(5),i=(n(16),n(17),n(3)),o=n(6),s=function(e,t,n){var r=Object(i.a)(t,2),a=r[0],c=r[1],o=8*Math.random();return{id:e,x:a,y:c,type:o>n?"foe":"heal",hp:o>n?Math.trunc(3*Math.random()+1):Math.trunc(4*Math.random()+5)}},u={id:4,x:1,y:1,type:"hero",hp:10},d=Object(o.b)({name:"cards",initialState:{isAIEnabled:!1,cards:Array(3).fill([]),scoreCount:0,hero:u,isGameOver:!0},reducers:{initFill:function(e){var t=-1;e.isAIEnabled=!1,e.scoreCount=0,e.hero=u;for(var n=0;n<3;n++)for(var r=0;r<3;r++)e.cards[n][r]=s(++t,[n,r],3);e.cards[e.hero.x][e.hero.y]=e.hero,e.isGameOver=!1},move:function(e,t){var n=Object(i.a)(t.payload,2),r=n[0],a=n[1],c=e.cards[r][a];if(function(e,t){var n=Object(i.a)(e,2),r=n[0],a=n[1],c=Object(i.a)(t,2),o=c[0],s=c[1];return(o!==r||s!==a)&&((o+1===r||o-1===r)&&s===a||(s+1===a||s-1===a)&&o===r)}([r,a],[e.hero.x,e.hero.y])){var o=function(e){return("foe"===e.type?-1:1)*e.hp}(c);e.hero.hp=Math.min(e.hero.hp+o,10),e.hero.hp<=0&&(alert("Game over! Your score ".concat(e.scoreCount)),e.isAIEnabled=!1,e.isGameOver=!0),o<0&&e.hero.hp>0&&e.scoreCount++,e.cards=function(e,t,n){var r=e.concat(),a=t.x===n.x?"x":"y",c="x"===a?"y":"x",i=r.flat().filter((function(e){return e[a]===t[a]})),o=i[n[c]<t[c]?i.length-1:0];r[n.x][n.y].type=t.type,r[n.x][n.y].hp=t.hp,"hero"!==o.type&&(r[t.x][t.y].type=o.type,r[t.x][t.y].hp=o.hp);var u=s(o.id,[o.x,o.y],2);return o.type=u.type,o.hp=u.hp,r}(e.cards,e.hero,c),e.hero=e.cards.flat().find((function(e){return"hero"===e.type}))}},enableAI:function(e){e.isAIEnabled=!0},disableAI:function(e){e.isAIEnabled=!1}}}),l=d.reducer,h=d.actions,f=h.initFill,b=h.move,p=h.enableAI,j=h.disableAI,v=n(4),m=function(){return Object(v.b)()},x=v.c,O=(n(24),n.p+"static/media/hero.5b2609bc.svg"),y=n.p+"static/media/hp0.013dd3c2.svg",g=n.p+"static/media/hp1.17d3ee61.svg",I={hero:{0:O},heal:{5:y,6:y,7:g,8:g},foe:{1:n.p+"static/media/foe1.c477179c.svg",2:n.p+"static/media/foe2.91be41a9.svg",3:n.p+"static/media/foe3.b4c66bde.svg"}},A=n(1);function E(){var e=x((function(e){var t=e.cardSlice;return{cards:t.cards.flat(),isGameOver:t.isGameOver,isAIEnabled:t.isAIEnabled}})),t=e.cards,n=e.isGameOver,a=e.isAIEnabled,c=m();return Object(r.useEffect)((function(){n&&c(f())}),[n]),Object(A.jsx)("div",{className:"cards-place",children:t.map((function(e){return Object(A.jsx)(C,{desc:e,isEnabled:a},e.id)}))})}function C(e){var t=m(),n=e.desc,r=I[n.type]["hero"===n.type?0:n.hp];return Object(A.jsxs)("button",{className:"card card-".concat(n.type),onClick:function(){t(b([n.x,n.y]))},disabled:e.isEnabled,children:[Object(A.jsx)("img",{src:r,alt:n.type,className:"card-image"}),Object(A.jsxs)("p",{className:"card-text",children:[" ",n.hp,"hero"===n.type?"/10":""]})]})}var G=n(9),S=n.n(G),k=n(11),N=function(e,t){var n=Object(i.a)(e,2),r=n[0],a=n[1];return t.filter((function(e){return e.x===r&&e.y+1===a||e.x===r&&e.y-1===a||e.x+1===r&&e.y===a||e.x-1===r&&e.y===a}))},F=function(e,t){var n=e.filter((function(e){return e.type===t}));return n?(n.sort((function(e,t){return e.hp<t.hp?-1:1})),n[0]):null},M=function(e,t,n,r){var a=e.map((function(e){return function(e,t){var n=N([e.x,e.y],t.flat()).filter((function(e){return"heal"===e.type})).length;return{id:e.id,amount:n}}(e,t)}));if(a.sort((function(e,t){return e.amount>t.amount?-1:1})),0===a[0].amount)return n;var c=a.filter((function(e){return e.amount===a[0].amount})).map((function(t){return e.find((function(e){return e.id===t.id}))})).sort((function(e,t){return e.hp<t.hp?-1:1}));console.log(JSON.stringify(c)+"\n\r\n\r");var i=c[0];return console.log(i," | ",n),i.hp<r.hp?i:n},w=function(){var e=x((function(e){var t=e.cardSlice;return{cards:t.cards,isGameOver:t.isGameOver,hero:t.hero,isAIEnabled:t.isAIEnabled}})),t=e.cards,n=e.isGameOver,a=e.hero,c=e.isAIEnabled,i=m();Object(r.useEffect)((function(){!n&&c&&o()}),[t]);var o=function(){setTimeout((function(){var e=function(e,t){var n=N([e.x,e.y],t.flat()),r=F(n,"heal"),a=function(e,t,n){return t?e&&n.hp>2*e.hp?e:t:e}(F(n,"foe"),r,e);return M(n,t,a,e)}(a,t);console.log(e),i(b([e.x,e.y]))}),1e3)},s=function(){var e=Object(k.a)(S.a.mark((function e(){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i(c?j():p()),o();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(A.jsx)(A.Fragment,{children:Object(A.jsx)("button",{className:"ai-button ".concat(c?"ai-active":""),onClick:function(){s()},children:c?"Disable auto play":"Enable auto play"})})};function D(){var e=x((function(e){return e.cardSlice.scoreCount}));return Object(A.jsxs)("div",{className:"stats",children:[Object(A.jsxs)("h3",{children:["Score: ",e]}),Object(A.jsx)(w,{})]})}var T=n(2),J=Object(T.b)({cardSlice:l}),B=Object(o.a)({reducer:J});var L=function(){return Object(A.jsx)(v.a,{store:B,children:Object(A.jsxs)("div",{className:"root",children:[Object(A.jsx)("header",{children:Object(A.jsx)("h1",{children:"Dungeon Cards AI"})}),Object(A.jsxs)("main",{children:[Object(A.jsx)(D,{}),Object(A.jsx)(E,{})]}),Object(A.jsxs)("footer",{children:[Object(A.jsx)("a",{target:"blank",href:"https://github.com/blackpawsstudio",children:"GitHub"}),Object(A.jsx)("a",{target:"blank",href:"https://play.google.com/store/apps/details?id=com.The717pixels.DungeonCards&hl=ru&gl=US",children:"Original game"})]})]})})},P=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,28)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),r(e),a(e),c(e),i(e)}))};Object(c.render)(Object(A.jsx)(a.a.StrictMode,{children:Object(A.jsx)(L,{})}),document.getElementById("root")),P()}},[[27,1,2]]]);
//# sourceMappingURL=main.4f27f994.chunk.js.map