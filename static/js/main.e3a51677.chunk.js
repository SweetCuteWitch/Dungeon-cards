(this["webpackJsonpdungeon-cards"]=this["webpackJsonpdungeon-cards"]||[]).push([[0],{16:function(e,t,n){},17:function(e,t,n){},24:function(e,t,n){},27:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(5),i=(n(16),n(17),n(3)),o=n(6),s=function(e,t,n){var r=Object(i.a)(t,2),a=r[0],c=r[1],o=8*Math.random()>n;return{id:e,x:a,y:c,type:o?"foe":"heal",hp:o?Math.trunc(3*Math.random()+1):Math.trunc(4*Math.random()+5)}},u={id:4,x:1,y:1,type:"hero",hp:10},d=Object(o.b)({name:"cards",initialState:{isAIEnabled:!1,cards:Array(3).fill([]),scoreCount:0,hero:u,isGameOver:!0,botSpeed:1e3},reducers:{initFill:function(e){var t=-1;e.isAIEnabled=!1,e.scoreCount=0,e.hero=u;for(var n=0;n<3;n++)for(var r=0;r<3;r++)e.cards[n][r]=s(++t,[n,r],3);e.cards[e.hero.x][e.hero.y]=e.hero,e.isGameOver=!1},move:function(e,t){var n=Object(i.a)(t.payload,2),r=n[0],a=n[1],c=e.cards[r][a];if(function(e,t){var n=Object(i.a)(e,2),r=n[0],a=n[1],c=Object(i.a)(t,2),o=c[0],s=c[1];return(o!==r||s!==a)&&((o+1===r||o-1===r)&&s===a||(s+1===a||s-1===a)&&o===r)}([r,a],[e.hero.x,e.hero.y])){var o=function(e){return("foe"===e.type?-1:1)*e.hp}(c);e.hero.hp=Math.min(e.hero.hp+o,10),e.hero.hp<=0&&(alert("Game over! Your score ".concat(e.scoreCount)),e.isAIEnabled=!1,e.isGameOver=!0),o<0&&e.hero.hp>0&&e.scoreCount++,e.cards=function(e,t,n,r){var a=e.concat(),c=t.x===n.x?"x":"y",i="x"===c?"y":"x",o=a.flat().filter((function(e){return e[c]===t[c]})),u=o[n[i]<t[i]?o.length-1:0];a[n.x][n.y].type=t.type,a[n.x][n.y].hp=t.hp,"hero"!==u.type&&(a[t.x][t.y].type=u.type,a[t.x][t.y].hp=u.hp);var d=s(u.id,[u.x,u.y],3);return u.type=d.type,u.hp=d.hp,a}(e.cards,e.hero,c,e.scoreCount),e.hero=e.cards.flat().find((function(e){return"hero"===e.type}))}},enableAI:function(e){e.isAIEnabled=!0},disableAI:function(e){e.isAIEnabled=!1},changeSpeed:function(e,t){var n=t.payload;e.botSpeed=1e3-n}}}),l=d.reducer,h=d.actions,f=h.initFill,p=h.move,b=h.enableAI,j=h.disableAI,v=h.changeSpeed,m=n(4),x=function(){return Object(m.b)()},O=m.c,y=(n(24),n.p+"static/media/hero.5b2609bc.svg"),g=n.p+"static/media/hp0.013dd3c2.svg",S=n.p+"static/media/hp1.17d3ee61.svg",I={hero:{0:y},heal:{5:g,6:g,7:S,8:S},foe:{1:n.p+"static/media/foe1.c477179c.svg",2:n.p+"static/media/foe2.91be41a9.svg",3:n.p+"static/media/foe3.b4c66bde.svg"}},A=n(1);function E(){var e=O((function(e){var t=e.cardSlice;return{cards:t.cards.flat(),isGameOver:t.isGameOver,isAIEnabled:t.isAIEnabled}})),t=e.cards,n=e.isGameOver,a=e.isAIEnabled,c=x();return Object(r.useEffect)((function(){n&&c(f())}),[n]),Object(A.jsx)("div",{className:"cards-place",children:t.map((function(e){return Object(A.jsx)(C,{desc:e,isEnabled:a},e.id)}))})}function C(e){var t=x(),n=e.desc,r=I[n.type]["hero"===n.type?0:n.hp];return Object(A.jsxs)("button",{className:"card card-".concat(n.type),onClick:function(){t(p([n.x,n.y]))},disabled:e.isEnabled,children:[Object(A.jsx)("img",{src:r,alt:n.type,className:"card-image"}),Object(A.jsxs)("p",{className:"card-text",children:[" ",n.hp,"hero"===n.type?"/10":""]})]})}var G=n(9),N=n.n(G),k=n(11),M=function(e,t){var n=Object(i.a)(e,2),r=n[0],a=n[1];return t.filter((function(e){return e.x===r&&e.y+1===a||e.x===r&&e.y-1===a||e.x+1===r&&e.y===a||e.x-1===r&&e.y===a}))},F=function(e,t){var n=e.filter((function(e){return e.type===t}));return n?(n.sort((function(e,t){return e.hp<t.hp?-1:1})),n[0]):null},w=function(e,t,n,r){var a=e.map((function(e){return function(e,t){var n=M([e.x,e.y],t.flat()).filter((function(e){return"heal"===e.type})).length;return{id:e.id,amount:n}}(e,t)}));if(a.sort((function(e,t){return e.amount>t.amount?-1:1})),0===a[0].amount)return n;var c=a.filter((function(e){return e.amount===a[0].amount})).map((function(t){return e.find((function(e){return e.id===t.id}))})).sort((function(e,t){return e.hp<t.hp?-1:1}))[0];return c.hp<r.hp?c:n},D=function(){var e=O((function(e){var t=e.cardSlice;return{cards:t.cards,isGameOver:t.isGameOver,hero:t.hero,isAIEnabled:t.isAIEnabled,botSpeed:t.botSpeed}})),t=e.cards,n=e.isGameOver,a=e.hero,c=e.isAIEnabled,i=e.botSpeed,o=x();Object(r.useEffect)((function(){!n&&c&&s()}),[t]);var s=function(){setTimeout((function(){var e=function(e,t){var n=M([e.x,e.y],t.flat()),r=F(n,"heal"),a=function(e,t,n){return t?e&&n.hp>e.hp+3?e:t:e}(F(n,"foe"),r,e);return w(n,t,a,e)}(a,t);o(p([e.x,e.y]))}),i)},u=function(){var e=Object(k.a)(N.a.mark((function e(){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o(c?j():b()),s();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(A.jsx)(A.Fragment,{children:Object(A.jsx)("button",{className:"ai-button ".concat(c?"ai-active":""),onClick:function(){u()},children:c?"Disable auto play":"Enable auto play"})})};function T(){var e=O((function(e){return e.cardSlice.scoreCount}));return Object(A.jsxs)("div",{className:"stats",children:[Object(A.jsxs)("h3",{children:["Score: ",e]}),Object(A.jsx)(D,{})]})}var _=n(2),B=Object(_.b)({cardSlice:l}),J=Object(o.a)({reducer:B}),L=function(){var e=O((function(e){return{botSpeed:e.cardSlice.botSpeed}})).botSpeed,t=x();return Object(A.jsxs)("div",{className:"settings",children:[Object(A.jsx)("input",{className:"settings__input",type:"range",min:"0",max:"1000",defaultValue:1,onChange:function(e){var n=e.target;t(v(n.value))}}),Object(A.jsxs)("p",{className:"setting__text",children:["AI speed: ",Math.trunc((1e3-e)/100)]})]})};var P=function(){return Object(A.jsx)(m.a,{store:J,children:Object(A.jsxs)("div",{className:"root",children:[Object(A.jsx)("header",{children:Object(A.jsx)("h1",{children:"Dungeon Cards AI"})}),Object(A.jsxs)("main",{children:[Object(A.jsx)(T,{}),Object(A.jsx)(L,{}),Object(A.jsx)(E,{})]}),Object(A.jsxs)("footer",{children:[Object(A.jsx)("a",{target:"blank",href:"https://github.com/blackpawsstudio",children:"GitHub"}),Object(A.jsx)("a",{target:"blank",href:"https://play.google.com/store/apps/details?id=com.The717pixels.DungeonCards&hl=ru&gl=US",children:"Original game"})]})]})})},H=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,28)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),r(e),a(e),c(e),i(e)}))};Object(c.render)(Object(A.jsx)(a.a.StrictMode,{children:Object(A.jsx)(P,{})}),document.getElementById("root")),H()}},[[27,1,2]]]);
//# sourceMappingURL=main.e3a51677.chunk.js.map